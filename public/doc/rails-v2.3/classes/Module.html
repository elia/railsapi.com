<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>Module</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../css/reset.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../css/main.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../css/github.css" type="text/css" media="screen" />
<script src="../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
<script src="../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
<script src="../js/main.js" type="text/javascript" charset="utf-8"></script>
<script src="../js/highlight.pack.js" type="text/javascript" charset="utf-8"></script>

</head>

<body>     
    <div class="banner">
        
        <h1>
            <span class="type">Class</span> 
            Module 
            
                <span class="parent">&lt; 
                    
                    <a href="Object.html">Object</a>
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../files/activesupport/lib/active_support/core_ext/module_rb.html">activesupport/lib/active_support/core_ext/module.rb</a></li>
            
            <li><a href="../files/activesupport/lib/active_support/core_ext/module/attr_accessor_with_default_rb.html">activesupport/lib/active_support/core_ext/module/attr_accessor_with_default.rb</a></li>
            
            <li><a href="../files/activesupport/lib/active_support/core_ext/module/attr_internal_rb.html">activesupport/lib/active_support/core_ext/module/attr_internal.rb</a></li>
            
            <li><a href="../files/activesupport/lib/active_support/core_ext/module/attribute_accessors_rb.html">activesupport/lib/active_support/core_ext/module/attribute_accessors.rb</a></li>
            
            <li><a href="../files/activesupport/lib/active_support/core_ext/module/delegation_rb.html">activesupport/lib/active_support/core_ext/module/delegation.rb</a></li>
            
            <li><a href="../files/activesupport/lib/active_support/core_ext/module/inclusion_rb.html">activesupport/lib/active_support/core_ext/module/inclusion.rb</a></li>
            
            <li><a href="../files/activesupport/lib/active_support/core_ext/module/loading_rb.html">activesupport/lib/active_support/core_ext/module/loading.rb</a></li>
            
            <li><a href="../files/activesupport/lib/active_support/core_ext/module/remove_method_rb.html">activesupport/lib/active_support/core_ext/module/remove_method.rb</a></li>
            
            <li><a href="../files/activesupport/lib/active_support/core_ext/module/synchronization_rb.html">activesupport/lib/active_support/core_ext/module/synchronization.rb</a></li>
            
            <li><a href="../files/activesupport/lib/active_support/deprecation_rb.html">activesupport/lib/active_support/deprecation.rb</a></li>
            
            <li><a href="../files/activesupport/lib/active_support/vendor/builder-2_1_2/blankslate_rb.html">activesupport/lib/active_support/vendor/builder-2.1.2/blankslate.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
  
    <div class="description">
      
<p>Extends the module object with module and instance accessors for class
attributes,  just like the native attr* accessors for instance attributes.</p>

<pre class="ruby"><span class="ruby-keyword">module</span> <span class="ruby-constant">AppConfiguration</span>
  <span class="ruby-identifier">mattr_accessor</span> :<span class="ruby-identifier">google_api_key</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">google_api_key</span> = <span class="ruby-string">&quot;123456789&quot;</span>

  <span class="ruby-identifier">mattr_accessor</span> :<span class="ruby-identifier">paypal_url</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">paypal_url</span> = <span class="ruby-string">&quot;www.sandbox.paypal.com&quot;</span>
<span class="ruby-keyword">end</span>

<span class="ruby-constant">AppConfiguration</span>.<span class="ruby-identifier">google_api_key</span> = <span class="ruby-string">&quot;overriding the api key!&quot;</span>
</pre>

<p>Also, modules included into <a href="Object.html">Object</a> need to be
scanned and have their instance methods removed from blank slate.  In
theory, modules included into <a href="Kernel.html">Kernel</a> would have
to be removed as well, but a “feature” of Ruby prevents late includes into
modules from being exposed in the first place.</p>

    </div>
  


  


  
  


  


  
    <!-- Method ref -->
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
      
        <dt>A</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-append_features">append_features</a>,
              </li>
            
              
              <li>
                <a href="#method-i-as_load_path">as_load_path</a>,
              </li>
            
              
              <li>
                <a href="#method-i-attr_accessor_with_default">attr_accessor_with_default</a>,
              </li>
            
              
              <li>
                <a href="#method-i-attr_internal">attr_internal</a>,
              </li>
            
              
              <li>
                <a href="#method-i-attr_internal_accessor">attr_internal_accessor</a>,
              </li>
            
              
              <li>
                <a href="#method-i-attr_internal_reader">attr_internal_reader</a>,
              </li>
            
              
              <li>
                <a href="#method-i-attr_internal_writer">attr_internal_writer</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>B</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-blankslate_original_append_features">blankslate_original_append_features</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>D</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-delegate">delegate</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>I</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-included_in_classes">included_in_classes</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>M</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-mattr_accessor">mattr_accessor</a>,
              </li>
            
              
              <li>
                <a href="#method-i-mattr_reader">mattr_reader</a>,
              </li>
            
              
              <li>
                <a href="#method-i-mattr_writer">mattr_writer</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>R</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-remove_possible_method">remove_possible_method</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>S</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-synchronize">synchronize</a>
              </li>
            
          </ul>
        </dd>
      
    </dl>
  

  
    <!-- Includes -->
    <div class="sectiontitle">Included Modules</div>
    <ul>
      
        <li>
          
            <a href="ActiveSupport/CoreExtensions/Module.html">
              ActiveSupport::CoreExtensions::Module
            </a>
          
        </li>
      
    </ul>
  



  

    

    

    


    


    <!-- Methods -->
        
      <div class="sectiontitle">Instance Public methods</div>
      
        <div class="method">
          <div class="title method-title" id="method-i-append_features">
            
              <b>append_features</b>(mod)
            
            <a href="../classes/Module.html#method-i-append_features" name="method-i-append_features" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
            <div class="aka">
              Also aliased as: <a href="Module.html#method-i-blankslate_original_append_features">blankslate_original_append_features</a>
            </div>
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-append_features_source')" id="l_method-i-append_features_source">show</a>
                
              </p>
              <div id="method-i-append_features_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activesupport/lib/active_support/vendor/builder-2.1.2/blankslate.rb, line 105</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">append_features</span>(<span class="ruby-identifier">mod</span>)
  <span class="ruby-identifier">result</span> = <span class="ruby-identifier">blankslate_original_append_features</span>(<span class="ruby-identifier">mod</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">result</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">mod</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">Object</span>
  <span class="ruby-identifier">instance_methods</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">name</span><span class="ruby-operator">|</span>
    <span class="ruby-constant">BlankSlate</span>.<span class="ruby-identifier">hide</span>(<span class="ruby-identifier">name</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">result</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-as_load_path">
            
              <b>as_load_path</b>()
            
            <a href="../classes/Module.html#method-i-as_load_path" name="method-i-as_load_path" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              <p>Returns String#underscore applied to the module name minus trailing
classes.</p>

<pre class="ruby"><span class="ruby-constant">ActiveRecord</span>.<span class="ruby-identifier">as_load_path</span>               <span class="ruby-comment"># =&gt; &quot;active_record&quot;</span>
<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Associations</span>.<span class="ruby-identifier">as_load_path</span> <span class="ruby-comment"># =&gt; &quot;active_record/associations&quot;</span>
<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">as_load_path</span>         <span class="ruby-comment"># =&gt; &quot;active_record&quot; (Base is a class)</span>
</pre>

<p>The <a href="Kernel.html">Kernel</a> module gives an empty string by
definition.</p>

<pre class="ruby"><span class="ruby-constant">Kernel</span>.<span class="ruby-identifier">as_load_path</span> <span class="ruby-comment"># =&gt; &quot;&quot;</span>
<span class="ruby-constant">Math</span>.<span class="ruby-identifier">as_load_path</span>   <span class="ruby-comment"># =&gt; &quot;math&quot;</span>
</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-as_load_path_source')" id="l_method-i-as_load_path_source">show</a>
                
              </p>
              <div id="method-i-as_load_path_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activesupport/lib/active_support/core_ext/module/loading.rb, line 12</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">as_load_path</span>
  <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span> <span class="ruby-operator">==</span> <span class="ruby-constant">Object</span> <span class="ruby-operator">||</span> <span class="ruby-keyword">self</span> <span class="ruby-operator">==</span> <span class="ruby-constant">Kernel</span>
    <span class="ruby-string">&#39;&#39;</span>
  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">is_a?</span> <span class="ruby-constant">Class</span>
    <span class="ruby-identifier">parent</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">self</span> <span class="ruby-operator">?</span> <span class="ruby-string">&#39;&#39;</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">parent</span>.<span class="ruby-identifier">as_load_path</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">name</span>.<span class="ruby-identifier">split</span>(<span class="ruby-string">&#39;::&#39;</span>).<span class="ruby-identifier">collect</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">word</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">word</span>.<span class="ruby-identifier">underscore</span>
    <span class="ruby-keyword">end</span> * <span class="ruby-string">&#39;/&#39;</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-attr_accessor_with_default">
            
              <b>attr_accessor_with_default</b>(sym, default = nil, &amp;block)
            
            <a href="../classes/Module.html#method-i-attr_accessor_with_default" name="method-i-attr_accessor_with_default" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              <p>Declare an attribute accessor with an initial default return value.</p>

<p>To give attribute <code>:age</code> the initial value <code>25</code>:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Person</span>
  <span class="ruby-identifier">attr_accessor_with_default</span> :<span class="ruby-identifier">age</span>, <span class="ruby-value">25</span>
<span class="ruby-keyword">end</span>

<span class="ruby-identifier">some_person</span>.<span class="ruby-identifier">age</span>
=<span class="ruby-operator">&gt;</span> <span class="ruby-value">25</span>
<span class="ruby-identifier">some_person</span>.<span class="ruby-identifier">age</span> = <span class="ruby-value">26</span>
<span class="ruby-identifier">some_person</span>.<span class="ruby-identifier">age</span>
=<span class="ruby-operator">&gt;</span> <span class="ruby-value">26</span>
</pre>

<p>To give attribute <code>:element_name</code> a dynamic default value,
evaluated in scope of self:</p>

<pre>attr_accessor_with_default(:element_name) { name.underscore }</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-attr_accessor_with_default_source')" id="l_method-i-attr_accessor_with_default_source">show</a>
                
              </p>
              <div id="method-i-attr_accessor_with_default_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activesupport/lib/active_support/core_ext/module/attr_accessor_with_default.rb, line 21</span>
  <span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">attr_accessor_with_default</span>(<span class="ruby-identifier">sym</span>, <span class="ruby-identifier">default</span> = <span class="ruby-keyword">nil</span>, &amp;<span class="ruby-identifier">block</span>)
    <span class="ruby-identifier">raise</span> <span class="ruby-string">&#39;Default value or block required&#39;</span> <span class="ruby-keyword">unless</span> <span class="ruby-operator">!</span><span class="ruby-identifier">default</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">block</span>
    <span class="ruby-identifier">define_method</span>(<span class="ruby-identifier">sym</span>, <span class="ruby-identifier">block_given?</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">block</span> <span class="ruby-operator">:</span> <span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span> { <span class="ruby-identifier">default</span> })
    <span class="ruby-identifier">module_eval</span>(<span class="ruby-string">&quot;      def #{sym}=(value)                        # def age=(value)
        class &lt;&lt; self; attr_reader :#{sym} end  #   class &lt;&lt; self; attr_reader :age end
        @#{sym} = value                         #   @age = value
      end                                       # end
&quot;</span>, <span class="ruby-keyword">__FILE__</span>, <span class="ruby-keyword">__LINE__</span> <span class="ruby-operator">+</span> <span class="ruby-number">1</span>)
  <span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-attr_internal">
            
              <b>attr_internal</b>(*attrs)
            
            <a href="../classes/Module.html#method-i-attr_internal" name="method-i-attr_internal" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-attr_internal_accessor">
            
              <b>attr_internal_accessor</b>(*attrs)
            
            <a href="../classes/Module.html#method-i-attr_internal_accessor" name="method-i-attr_internal_accessor" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              <p>Declares an attribute reader and writer backed by an internally-named
instance variable.</p>
            </div>
          
          
          
            <div class="aka">
              Also aliased as: <a href="Module.html#method-i-attr_internal">attr_internal</a>
            </div>
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-attr_internal_accessor_source')" id="l_method-i-attr_internal_accessor_source">show</a>
                
              </p>
              <div id="method-i-attr_internal_accessor_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activesupport/lib/active_support/core_ext/module/attr_internal.rb, line 18</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">attr_internal_accessor</span>(*<span class="ruby-identifier">attrs</span>)
  <span class="ruby-identifier">attr_internal_reader</span>(*<span class="ruby-identifier">attrs</span>)
  <span class="ruby-identifier">attr_internal_writer</span>(*<span class="ruby-identifier">attrs</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-attr_internal_reader">
            
              <b>attr_internal_reader</b>(*attrs)
            
            <a href="../classes/Module.html#method-i-attr_internal_reader" name="method-i-attr_internal_reader" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              <p>Declares an attribute reader backed by an internally-named instance
variable.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-attr_internal_reader_source')" id="l_method-i-attr_internal_reader_source">show</a>
                
              </p>
              <div id="method-i-attr_internal_reader_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activesupport/lib/active_support/core_ext/module/attr_internal.rb, line 3</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">attr_internal_reader</span>(*<span class="ruby-identifier">attrs</span>)
  <span class="ruby-identifier">attrs</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">attr</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">module_eval</span> <span class="ruby-node">&quot;def #{attr}() #{attr_internal_ivar_name(attr)} end&quot;</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-attr_internal_writer">
            
              <b>attr_internal_writer</b>(*attrs)
            
            <a href="../classes/Module.html#method-i-attr_internal_writer" name="method-i-attr_internal_writer" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              <p>Declares an attribute writer backed by an internally-named instance
variable.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-attr_internal_writer_source')" id="l_method-i-attr_internal_writer_source">show</a>
                
              </p>
              <div id="method-i-attr_internal_writer_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activesupport/lib/active_support/core_ext/module/attr_internal.rb, line 10</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">attr_internal_writer</span>(*<span class="ruby-identifier">attrs</span>)
  <span class="ruby-identifier">attrs</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">attr</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">module_eval</span> <span class="ruby-node">&quot;def #{attr}=(v) #{attr_internal_ivar_name(attr)} = v end&quot;</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-blankslate_original_append_features">
            
              <b>blankslate_original_append_features</b>(mod)
            
            <a href="../classes/Module.html#method-i-blankslate_original_append_features" name="method-i-blankslate_original_append_features" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-delegate">
            
              <b>delegate</b>(*methods)
            
            <a href="../classes/Module.html#method-i-delegate" name="method-i-delegate" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              <p>Provides a delegate class method to easily expose contained objects&#39;
methods as your own. Pass one or more methods (specified as symbols or
strings) and the name of the target object as the final <code>:to</code>
option (also a symbol or string).  At least one method and the
<code>:to</code> option are required.</p>

<p>Delegation is particularly useful with Active Record associations:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Greeter</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-keyword">def</span> <span class="ruby-identifier">hello</span>()   <span class="ruby-string">&quot;hello&quot;</span>   <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">def</span> <span class="ruby-identifier">goodbye</span>() <span class="ruby-string">&quot;goodbye&quot;</span> <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>

<span class="ruby-keyword">class</span> <span class="ruby-constant">Foo</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">belongs_to</span> :<span class="ruby-identifier">greeter</span>
  <span class="ruby-identifier">delegate</span> :<span class="ruby-identifier">hello</span>, :<span class="ruby-identifier">to</span> =<span class="ruby-operator">&gt;</span> :<span class="ruby-identifier">greeter</span>
<span class="ruby-keyword">end</span>

<span class="ruby-constant">Foo</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">hello</span>   <span class="ruby-comment"># =&gt; &quot;hello&quot;</span>
<span class="ruby-constant">Foo</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">goodbye</span> <span class="ruby-comment"># =&gt; NoMethodError: undefined method `goodbye&#39; for #&lt;Foo:0x1af30c&gt;</span>
</pre>

<p>Multiple delegates to the same target are allowed:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Foo</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">belongs_to</span> :<span class="ruby-identifier">greeter</span>
  <span class="ruby-identifier">delegate</span> :<span class="ruby-identifier">hello</span>, :<span class="ruby-identifier">goodbye</span>, :<span class="ruby-identifier">to</span> =<span class="ruby-operator">&gt;</span> :<span class="ruby-identifier">greeter</span>
<span class="ruby-keyword">end</span>

<span class="ruby-constant">Foo</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">goodbye</span> <span class="ruby-comment"># =&gt; &quot;goodbye&quot;</span>
</pre>

<p>Methods can be delegated to instance variables, class variables, or
constants by providing them as a symbols:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Foo</span>
  <span class="ruby-constant">CONSTANT_ARRAY</span> = [<span class="ruby-value">0</span>,<span class="ruby-value">1</span>,<span class="ruby-value">2</span>,<span class="ruby-value">3</span>]
  <span class="ruby-identifier">@@class_array</span>  = [<span class="ruby-value">4</span>,<span class="ruby-value">5</span>,<span class="ruby-value">6</span>,<span class="ruby-value">7</span>]

  <span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>
    <span class="ruby-ivar">@instance_array</span> = [<span class="ruby-value">8</span>,<span class="ruby-value">9</span>,<span class="ruby-value">10</span>,<span class="ruby-value">11</span>]
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">delegate</span> :<span class="ruby-identifier">sum</span>, :<span class="ruby-identifier">to</span> =<span class="ruby-operator">&gt;</span> :<span class="ruby-constant">CONSTANT_ARRAY</span>
  <span class="ruby-identifier">delegate</span> :<span class="ruby-identifier">min</span>, :<span class="ruby-identifier">to</span> =<span class="ruby-operator">&gt;</span> :<span class="ruby-identifier">@@class_array</span>
  <span class="ruby-identifier">delegate</span> :<span class="ruby-identifier">max</span>, :<span class="ruby-identifier">to</span> =<span class="ruby-operator">&gt;</span> :<span class="ruby-ivar">@instance_array</span>
<span class="ruby-keyword">end</span>

<span class="ruby-constant">Foo</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">sum</span> <span class="ruby-comment"># =&gt; 6</span>
<span class="ruby-constant">Foo</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">min</span> <span class="ruby-comment"># =&gt; 4</span>
<span class="ruby-constant">Foo</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">max</span> <span class="ruby-comment"># =&gt; 11</span>
</pre>

<p>Delegates can optionally be prefixed using the <code>:prefix</code> option.
If the value is <code>true</code>, the delegate methods are prefixed with
the name of the object being delegated to.</p>

<pre class="ruby"><span class="ruby-constant">Person</span> = <span class="ruby-constant">Struct</span>.<span class="ruby-identifier">new</span>(:<span class="ruby-identifier">name</span>, :<span class="ruby-identifier">address</span>)

<span class="ruby-keyword">class</span> <span class="ruby-constant">Invoice</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">Struct</span>.<span class="ruby-identifier">new</span>(:<span class="ruby-identifier">client</span>)
  <span class="ruby-identifier">delegate</span> :<span class="ruby-identifier">name</span>, :<span class="ruby-identifier">address</span>, :<span class="ruby-identifier">to</span> =<span class="ruby-operator">&gt;</span> :<span class="ruby-identifier">client</span>, :<span class="ruby-identifier">prefix</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>
<span class="ruby-keyword">end</span>

<span class="ruby-identifier">john_doe</span> = <span class="ruby-constant">Person</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;John Doe&quot;</span>, <span class="ruby-string">&quot;Vimmersvej 13&quot;</span>)
<span class="ruby-identifier">invoice</span> = <span class="ruby-constant">Invoice</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">john_doe</span>)
<span class="ruby-identifier">invoice</span>.<span class="ruby-identifier">client_name</span>    <span class="ruby-comment"># =&gt; &quot;John Doe&quot;</span>
<span class="ruby-identifier">invoice</span>.<span class="ruby-identifier">client_address</span> <span class="ruby-comment"># =&gt; &quot;Vimmersvej 13&quot;</span>
</pre>

<p>It is also possible to supply a custom prefix.</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Invoice</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">Struct</span>.<span class="ruby-identifier">new</span>(:<span class="ruby-identifier">client</span>)
  <span class="ruby-identifier">delegate</span> :<span class="ruby-identifier">name</span>, :<span class="ruby-identifier">address</span>, :<span class="ruby-identifier">to</span> =<span class="ruby-operator">&gt;</span> :<span class="ruby-identifier">client</span>, :<span class="ruby-identifier">prefix</span> =<span class="ruby-operator">&gt;</span> :<span class="ruby-identifier">customer</span>
<span class="ruby-keyword">end</span>

<span class="ruby-identifier">invoice</span> = <span class="ruby-constant">Invoice</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">john_doe</span>)
<span class="ruby-identifier">invoice</span>.<span class="ruby-identifier">customer_name</span>    <span class="ruby-comment"># =&gt; &quot;John Doe&quot;</span>
<span class="ruby-identifier">invoice</span>.<span class="ruby-identifier">customer_address</span> <span class="ruby-comment"># =&gt; &quot;Vimmersvej 13&quot;</span>
</pre>

<p>If the object to which you delegate can be nil, you may want to use the
:allow_nil option. In that case, it returns nil instead of raising a
NoMethodError exception:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Foo</span>
  <span class="ruby-identifier">attr_accessor</span> :<span class="ruby-identifier">bar</span>
  <span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">bar</span> = <span class="ruby-keyword">nil</span>)
    <span class="ruby-ivar">@bar</span> = <span class="ruby-identifier">bar</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">delegate</span> :<span class="ruby-identifier">zoo</span>, :<span class="ruby-identifier">to</span> =<span class="ruby-operator">&gt;</span> :<span class="ruby-identifier">bar</span>
<span class="ruby-keyword">end</span>

<span class="ruby-constant">Foo</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">zoo</span>   <span class="ruby-comment"># raises NoMethodError exception (you called nil.zoo)</span>

<span class="ruby-keyword">class</span> <span class="ruby-constant">Foo</span>
  <span class="ruby-identifier">attr_accessor</span> :<span class="ruby-identifier">bar</span>
  <span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">bar</span> = <span class="ruby-keyword">nil</span>)
    <span class="ruby-ivar">@bar</span> = <span class="ruby-identifier">bar</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">delegate</span> :<span class="ruby-identifier">zoo</span>, :<span class="ruby-identifier">to</span> =<span class="ruby-operator">&gt;</span> :<span class="ruby-identifier">bar</span>, :<span class="ruby-identifier">allow_nil</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>
<span class="ruby-keyword">end</span>

<span class="ruby-constant">Foo</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">zoo</span>   <span class="ruby-comment"># returns nil</span>
</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-delegate_source')" id="l_method-i-delegate_source">show</a>
                
              </p>
              <div id="method-i-delegate_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activesupport/lib/active_support/core_ext/module/delegation.rb, line 99</span>
  <span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">delegate</span>(*<span class="ruby-identifier">methods</span>)
    <span class="ruby-identifier">options</span> = <span class="ruby-identifier">methods</span>.<span class="ruby-identifier">pop</span>
    <span class="ruby-keyword">unless</span> <span class="ruby-identifier">options</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">to</span> = <span class="ruby-identifier">options</span>[<span class="ruby-value">:to</span>]
      <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-string">&quot;Delegation needs a target. Supply an options hash with a :to key as the last argument (e.g. delegate :hello, :to =&gt; :greeter).&quot;</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-keyword">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:prefix</span>] <span class="ruby-operator">==</span> <span class="ruby-keyword">true</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:to</span>].<span class="ruby-identifier">to_s</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/^[^a-z_]/</span>
      <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-string">&quot;Can only automatically set the delegation prefix when delegating to a method.&quot;</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-identifier">prefix</span> = <span class="ruby-identifier">options</span>[<span class="ruby-value">:prefix</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-node">&quot;#{options[:prefix] == true ? to : options[:prefix]}_&quot;</span>

    <span class="ruby-identifier">file</span>, <span class="ruby-identifier">line</span> = <span class="ruby-identifier">caller</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">split</span>(<span class="ruby-string">&#39;:&#39;</span>, <span class="ruby-number">2</span>)
    <span class="ruby-identifier">line</span> = <span class="ruby-identifier">line</span>.<span class="ruby-identifier">to_i</span>

    <span class="ruby-identifier">methods</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">method</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">on_nil</span> =
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:allow_nil</span>]
          <span class="ruby-string">&#39;return&#39;</span>
        <span class="ruby-keyword">else</span>
          <span class="ruby-node">%Q(raise &quot;#{prefix}#{method} delegated to #{to}.#{method}, but #{to} is nil: \#{self.inspect}&quot;)</span>
        <span class="ruby-keyword">end</span>

      <span class="ruby-identifier">module_eval</span>(<span class="ruby-string">&quot;        def #{prefix}#{method}(*args, &amp;block)               # def customer_name(*args, &amp;block)
          #{to}.__send__(#{method.inspect}, *args, &amp;block)  #   client.__send__(:name, *args, &amp;block)
        rescue NoMethodError                                # rescue NoMethodError
          if #{to}.nil?                                     #   if client.nil?
            #{on_nil}
          else                                              #   else
            raise                                           #     raise
          end                                               #   end
        end                                                 # end
&quot;</span>, <span class="ruby-identifier">file</span>, <span class="ruby-identifier">line</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-included_in_classes">
            
              <b>included_in_classes</b>()
            
            <a href="../classes/Module.html#method-i-included_in_classes" name="method-i-included_in_classes" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              <p>Returns the classes in the current ObjectSpace where this module has been
mixed in according to Module#included_modules.</p>

<pre class="ruby"><span class="ruby-keyword">module</span> <span class="ruby-constant">M</span>
<span class="ruby-keyword">end</span>

<span class="ruby-keyword">module</span> <span class="ruby-constant">N</span>
  <span class="ruby-identifier">include</span> <span class="ruby-constant">M</span>
<span class="ruby-keyword">end</span>

<span class="ruby-keyword">class</span> <span class="ruby-constant">C</span>
  <span class="ruby-identifier">include</span> <span class="ruby-constant">M</span>
<span class="ruby-keyword">end</span>

<span class="ruby-keyword">class</span> <span class="ruby-constant">D</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">C</span>
<span class="ruby-keyword">end</span>

<span class="ruby-identifier">p</span> <span class="ruby-constant">M</span>.<span class="ruby-identifier">included_in_classes</span> <span class="ruby-comment"># =&gt; [C, D]</span>
</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-included_in_classes_source')" id="l_method-i-included_in_classes_source">show</a>
                
              </p>
              <div id="method-i-included_in_classes_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activesupport/lib/active_support/core_ext/module/inclusion.rb, line 21</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">included_in_classes</span>
  <span class="ruby-identifier">classes</span> = []
  <span class="ruby-constant">ObjectSpace</span>.<span class="ruby-identifier">each_object</span>(<span class="ruby-constant">Class</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">k</span><span class="ruby-operator">|</span> <span class="ruby-identifier">classes</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">k</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">k</span>.<span class="ruby-identifier">included_modules</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-keyword">self</span>) }

  <span class="ruby-identifier">classes</span>.<span class="ruby-identifier">reverse</span>.<span class="ruby-identifier">inject</span>([]) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">unique_classes</span>, <span class="ruby-identifier">klass</span><span class="ruby-operator">|</span> 
    <span class="ruby-identifier">unique_classes</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">klass</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">unique_classes</span>.<span class="ruby-identifier">collect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">k</span><span class="ruby-operator">|</span> <span class="ruby-identifier">k</span>.<span class="ruby-identifier">to_s</span> }.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">klass</span>.<span class="ruby-identifier">to_s</span>)
    <span class="ruby-identifier">unique_classes</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-mattr_accessor">
            
              <b>mattr_accessor</b>(*syms)
            
            <a href="../classes/Module.html#method-i-mattr_accessor" name="method-i-mattr_accessor" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-mattr_accessor_source')" id="l_method-i-mattr_accessor_source">show</a>
                
              </p>
              <div id="method-i-mattr_accessor_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activesupport/lib/active_support/core_ext/module/attribute_accessors.rb, line 63</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">mattr_accessor</span>(*<span class="ruby-identifier">syms</span>)
  <span class="ruby-identifier">mattr_reader</span>(*<span class="ruby-identifier">syms</span>)
  <span class="ruby-identifier">mattr_writer</span>(*<span class="ruby-identifier">syms</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-mattr_reader">
            
              <b>mattr_reader</b>(*syms)
            
            <a href="../classes/Module.html#method-i-mattr_reader" name="method-i-mattr_reader" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-mattr_reader_source')" id="l_method-i-mattr_reader_source">show</a>
                
              </p>
              <div id="method-i-mattr_reader_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activesupport/lib/active_support/core_ext/module/attribute_accessors.rb, line 16</span>
  <span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">mattr_reader</span>(*<span class="ruby-identifier">syms</span>)
    <span class="ruby-identifier">options</span> = <span class="ruby-identifier">syms</span>.<span class="ruby-identifier">extract_options!</span>
    <span class="ruby-identifier">syms</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">sym</span><span class="ruby-operator">|</span>
      <span class="ruby-keyword">next</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">sym</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)
      <span class="ruby-identifier">class_eval</span>(<span class="ruby-string">&quot;        unless defined? @@#{sym}
          @@#{sym} = nil
        end

        def self.#{sym}
          @@#{sym}
        end
&quot;</span>, <span class="ruby-keyword">__FILE__</span>, <span class="ruby-keyword">__LINE__</span> <span class="ruby-operator">+</span> <span class="ruby-number">1</span>)

      <span class="ruby-keyword">unless</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:instance_reader</span>] <span class="ruby-operator">==</span> <span class="ruby-keyword">false</span>
        <span class="ruby-identifier">class_eval</span>(<span class="ruby-string">&quot;          def #{sym}
            @@#{sym}
          end
&quot;</span>, <span class="ruby-keyword">__FILE__</span>, <span class="ruby-keyword">__LINE__</span> <span class="ruby-operator">+</span> <span class="ruby-number">1</span>)
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-mattr_writer">
            
              <b>mattr_writer</b>(*syms)
            
            <a href="../classes/Module.html#method-i-mattr_writer" name="method-i-mattr_writer" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-mattr_writer_source')" id="l_method-i-mattr_writer_source">show</a>
                
              </p>
              <div id="method-i-mattr_writer_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activesupport/lib/active_support/core_ext/module/attribute_accessors.rb, line 40</span>
  <span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">mattr_writer</span>(*<span class="ruby-identifier">syms</span>)
    <span class="ruby-identifier">options</span> = <span class="ruby-identifier">syms</span>.<span class="ruby-identifier">extract_options!</span>
    <span class="ruby-identifier">syms</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">sym</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">class_eval</span>(<span class="ruby-string">&quot;        unless defined? @@#{sym}
          @@#{sym} = nil
        end

        def self.#{sym}=(obj)
          @@#{sym} = obj
        end
&quot;</span>, <span class="ruby-keyword">__FILE__</span>, <span class="ruby-keyword">__LINE__</span> <span class="ruby-operator">+</span> <span class="ruby-number">1</span>)

      <span class="ruby-keyword">unless</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:instance_writer</span>] <span class="ruby-operator">==</span> <span class="ruby-keyword">false</span>
        <span class="ruby-identifier">class_eval</span>(<span class="ruby-string">&quot;          def #{sym}=(obj)
            @@#{sym} = obj
          end
&quot;</span>, <span class="ruby-keyword">__FILE__</span>, <span class="ruby-keyword">__LINE__</span> <span class="ruby-operator">+</span> <span class="ruby-number">1</span>)
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-remove_possible_method">
            
              <b>remove_possible_method</b>(method)
            
            <a href="../classes/Module.html#method-i-remove_possible_method" name="method-i-remove_possible_method" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-remove_possible_method_source')" id="l_method-i-remove_possible_method_source">show</a>
                
              </p>
              <div id="method-i-remove_possible_method_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activesupport/lib/active_support/core_ext/module/remove_method.rb, line 2</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">remove_possible_method</span>(<span class="ruby-identifier">method</span>)
  <span class="ruby-identifier">remove_method</span>(<span class="ruby-identifier">method</span>)
<span class="ruby-keyword">rescue</span> <span class="ruby-constant">NameError</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-synchronize">
            
              <b>synchronize</b>(*methods)
            
            <a href="../classes/Module.html#method-i-synchronize" name="method-i-synchronize" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              <p>Synchronize access around a method, delegating synchronization to a
particular mutex. A mutex (either a Mutex, or any object that responds to 
<a href="Module.html#method-i-synchronize">synchronize</a> and yields to a
block) must be provided as a final :with option. The :with option should be
a symbol or string, and can represent a method,  constant, or instance or
class variable. Example:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">SharedCache</span>
  <span class="ruby-identifier">@@lock</span> = <span class="ruby-constant">Mutex</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-keyword">def</span> <span class="ruby-identifier">expire</span>
    <span class="ruby-operator">...</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">synchronize</span> :<span class="ruby-identifier">expire</span>, :<span class="ruby-identifier">with</span> =<span class="ruby-operator">&gt;</span> :<span class="ruby-identifier">@@lock</span>
<span class="ruby-keyword">end</span>
</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-synchronize_source')" id="l_method-i-synchronize_source">show</a>
                
              </p>
              <div id="method-i-synchronize_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activesupport/lib/active_support/core_ext/module/synchronization.rb, line 15</span>
  <span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">synchronize</span>(*<span class="ruby-identifier">methods</span>)
    <span class="ruby-identifier">options</span> = <span class="ruby-identifier">methods</span>.<span class="ruby-identifier">extract_options!</span>
    <span class="ruby-keyword">unless</span> <span class="ruby-identifier">options</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">with</span> = <span class="ruby-identifier">options</span>[<span class="ruby-value">:with</span>]
      <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-string">&quot;Synchronization needs a mutex. Supply an options hash with a :with key as the last argument (e.g. synchronize :hello, :with =&gt; :@mutex).&quot;</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-identifier">methods</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">method</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">aliased_method</span>, <span class="ruby-identifier">punctuation</span> = <span class="ruby-identifier">method</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-regexp">/([?!=])$/</span>, <span class="ruby-string">&#39;&#39;</span>), <span class="ruby-node">$1</span>

      <span class="ruby-keyword">if</span> <span class="ruby-identifier">method_defined?</span>(<span class="ruby-node">&quot;#{aliased_method}_without_synchronization#{punctuation}&quot;</span>)
        <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-node">&quot;#{method} is already synchronized. Double synchronization is not currently supported.&quot;</span>
      <span class="ruby-keyword">end</span>

      <span class="ruby-identifier">module_eval</span>(<span class="ruby-string">&quot;        def #{aliased_method}_with_synchronization#{punctuation}(*args, &amp;block)     # def expire_with_synchronization(*args, &amp;block)
          #{with}.synchronize do                                                    #   @@lock.synchronize do
            #{aliased_method}_without_synchronization#{punctuation}(*args, &amp;block)  #     expire_without_synchronization(*args, &amp;block)
          end                                                                       #   end
        end                                                                         # end
&quot;</span>, <span class="ruby-keyword">__FILE__</span>, <span class="ruby-keyword">__LINE__</span> <span class="ruby-operator">+</span> <span class="ruby-number">1</span>)

      <span class="ruby-identifier">alias_method_chain</span> <span class="ruby-identifier">method</span>, <span class="ruby-value">:synchronization</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
                    </div>

    </div>
  </body>
</html>    