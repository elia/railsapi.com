<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>ActionController::Helpers::ClassMethods</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../../../css/reset.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../../../css/main.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../../../css/github.css" type="text/css" media="screen" />
<script src="../../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
<script src="../../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
<script src="../../../js/main.js" type="text/javascript" charset="utf-8"></script>
<script src="../../../js/highlight.pack.js" type="text/javascript" charset="utf-8"></script>

</head>

<body>     
    <div class="banner">
        
        <h1>
            <span class="type">Module</span> 
            ActionController::Helpers::ClassMethods 
            
        </h1>
        <ul class="files">
            
            <li><a href="../../../files/actionpack/lib/action_controller/helpers_rb.html">actionpack/lib/action_controller/helpers.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
  
    <div class="description">
      
<p>The <a href="../../Rails.html">Rails</a> framework provides a large number
of helpers for working with <code>assets</code>, <code>dates</code>,
<code>forms</code>,  <code>numbers</code> and Active Record objects, to
name a few. These helpers are available to all templates by default.</p>

<p>In addition to using the standard template helpers provided in the <a
href="../../Rails.html">Rails</a> framework, creating custom helpers to
extract complicated logic or reusable functionality is strongly encouraged.
By default, the controller will  include a helper whose name matches that
of the controller, e.g., <code>MyController</code> will automatically
include <code>MyHelper</code>.</p>

<p>Additional helpers can be specified using the <code>helper</code> class
method in <code>ActionController::Base</code> or any controller which
inherits from it.</p>

<h4 id="label-Examples">Examples</h4>

<p>The <code>to_s</code> method from the <a href="../../Time.html">Time</a>
class can be wrapped in a helper method to display a custom message if  the
<a href="../../Time.html">Time</a> object is blank:</p>

<pre class="ruby"><span class="ruby-keyword">module</span> <span class="ruby-constant">FormattedTimeHelper</span>
  <span class="ruby-keyword">def</span> <span class="ruby-identifier">format_time</span>(<span class="ruby-identifier">time</span>, <span class="ruby-identifier">format</span>=:<span class="ruby-identifier">long</span>, <span class="ruby-identifier">blank_message</span>=<span class="ruby-string">&quot;&amp;nbsp;&quot;</span>)
    <span class="ruby-identifier">time</span>.<span class="ruby-identifier">blank?</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">blank_message</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">time</span>.<span class="ruby-identifier">to_s</span>(<span class="ruby-identifier">format</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p>FormattedTimeHelper can now be included in a controller, using the
<code>helper</code> class method:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">EventsController</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActionController</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">helper</span> <span class="ruby-constant">FormattedTimeHelper</span>
  <span class="ruby-keyword">def</span> <span class="ruby-identifier">index</span>
    <span class="ruby-ivar">@events</span> = <span class="ruby-constant">Event</span>.<span class="ruby-identifier">find</span>(:<span class="ruby-identifier">all</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p>Then, in any view rendered by <code>EventController</code>, the
<code>format_time</code> method can be called:</p>

<pre>&lt;% @events.each do |event| -%&gt;
  &lt;p&gt;
    &lt;% format_time(event.time, :short, &quot;N/A&quot;) %&gt; | &lt;%= event.name %&gt; 
  &lt;/p&gt;
&lt;% end -%&gt;</pre>

<p>Finally, assuming we have two event instances, one which has a time and one
which does not,  the output might look like this:</p>

<pre>23 Aug 11:30 | Carolina Railhawks Soccer Match 
N/A | Carolina Railhaws Training Workshop</pre>

    </div>
  


  


  
  


  


  
    <!-- Method ref -->
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
      
        <dt>H</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-helper">helper</a>,
              </li>
            
              
              <li>
                <a href="#method-i-helper_attr">helper_attr</a>,
              </li>
            
              
              <li>
                <a href="#method-i-helper_method">helper_method</a>,
              </li>
            
              
              <li>
                <a href="#method-i-helpers">helpers</a>
              </li>
            
          </ul>
        </dd>
      
    </dl>
  

  



  

    

    

    


    


    <!-- Methods -->
        
      <div class="sectiontitle">Instance Public methods</div>
      
        <div class="method">
          <div class="title method-title" id="method-i-helper">
            
              <b>helper</b>(*args, &amp;block)
            
            <a href="../../../classes/ActionController/Helpers/ClassMethods.html#method-i-helper" name="method-i-helper" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              <p>The <code>helper</code> class method can take a series of helper module
names, a block, or both.</p>
<ul><li>
<p><code>*args</code>: One or more modules, strings or symbols, or the special
symbol <code>:all</code>.</p>
</li><li>
<p><code>&amp;block</code>: A block defining helper methods.</p>
</li></ul>

<h4 id="method-i-helper-label-Examples">Examples</h4>

<p>When the argument is a string or symbol, the method will provide the
“_helper” suffix, require the file  and include the module in the template
class.  The second form illustrates how to include custom helpers  when
working with namespaced controllers, or other cases where the file
containing the helper definition is not in one of Rails&#39; standard load
paths:</p>

<pre class="ruby"><span class="ruby-identifier">helper</span> :<span class="ruby-identifier">foo</span>             <span class="ruby-comment"># =&gt; requires &#39;foo_helper&#39; and includes FooHelper</span>
<span class="ruby-identifier">helper</span> <span class="ruby-string">&#39;resources/foo&#39;</span>  <span class="ruby-comment"># =&gt; requires &#39;resources/foo_helper&#39; and includes Resources::FooHelper</span>
</pre>

<p>When the argument is a module it will be included directly in the template
class.</p>

<pre class="ruby"><span class="ruby-identifier">helper</span> <span class="ruby-constant">FooHelper</span> <span class="ruby-comment"># =&gt; includes FooHelper</span>
</pre>

<p>When the argument is the symbol <code>:all</code>, the controller will
include all helpers beneath <code>ActionController::Base.helpers_dir</code>
(defaults to <code>app/helpers   /*.rb</code> under RAILS_ROOT).</p>

<pre>helper :all</pre>

<p>Additionally, the <code>helper</code> class method can receive and evaluate
a block, making the methods defined available  to the template.</p>

<pre class="ruby"><span class="ruby-comment"># One line</span>
<span class="ruby-identifier">helper</span> { <span class="ruby-keyword">def</span> <span class="ruby-identifier">hello</span>() <span class="ruby-string">&quot;Hello, world!&quot;</span> <span class="ruby-keyword">end</span> }
<span class="ruby-comment"># Multi-line</span>
<span class="ruby-identifier">helper</span> <span class="ruby-keyword">do</span>
  <span class="ruby-keyword">def</span> <span class="ruby-identifier">foo</span>(<span class="ruby-identifier">bar</span>) 
    <span class="ruby-node">&quot;#{bar} is the very best&quot;</span> 
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p>Finally, all the above styles can be mixed together, and the
<code>helper</code> method can be invoked with a mix of
<code>symbols</code>, <code>strings</code>, <code>modules</code> and
blocks.</p>

<pre class="ruby"><span class="ruby-identifier">helper</span>(:<span class="ruby-identifier">three</span>, <span class="ruby-constant">BlindHelper</span>) { <span class="ruby-keyword">def</span> <span class="ruby-identifier">mice</span>() <span class="ruby-string">&#39;mice&#39;</span> <span class="ruby-keyword">end</span> }
</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-helper_source')" id="l_method-i-helper_source">show</a>
                
              </p>
              <div id="method-i-helper_source" class="dyn-source">
                <pre><span class="ruby-comment"># File actionpack/lib/action_controller/helpers.rb, line 114</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">helper</span>(*<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">args</span>.<span class="ruby-identifier">flatten</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">arg</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">case</span> <span class="ruby-identifier">arg</span>
      <span class="ruby-keyword">when</span> <span class="ruby-constant">Module</span>
        <span class="ruby-identifier">add_template_helper</span>(<span class="ruby-identifier">arg</span>)
      <span class="ruby-keyword">when</span> <span class="ruby-value">:all</span>
        <span class="ruby-identifier">helper</span>(<span class="ruby-identifier">all_application_helpers</span>)
      <span class="ruby-keyword">when</span> <span class="ruby-constant">String</span>, <span class="ruby-constant">Symbol</span>
        <span class="ruby-identifier">file_name</span>  = <span class="ruby-identifier">arg</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">underscore</span> <span class="ruby-operator">+</span> <span class="ruby-string">&#39;_helper&#39;</span>
        <span class="ruby-identifier">class_name</span> = <span class="ruby-identifier">file_name</span>.<span class="ruby-identifier">camelize</span>

        <span class="ruby-keyword">begin</span>
          <span class="ruby-identifier">require_dependency</span>(<span class="ruby-identifier">file_name</span>)
        <span class="ruby-keyword">rescue</span> <span class="ruby-constant">LoadError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">load_error</span>
          <span class="ruby-identifier">requiree</span> = <span class="ruby-regexp">/ -- (.*?)(\.rb)?$/</span>.<span class="ruby-identifier">match</span>(<span class="ruby-identifier">load_error</span>.<span class="ruby-identifier">message</span>).<span class="ruby-identifier">to_a</span>[<span class="ruby-number">1</span>]
          <span class="ruby-keyword">if</span> <span class="ruby-identifier">requiree</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">file_name</span>
            <span class="ruby-identifier">msg</span> = <span class="ruby-node">&quot;Missing helper file helpers/#{file_name}.rb&quot;</span>
            <span class="ruby-identifier">raise</span> <span class="ruby-constant">LoadError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">msg</span>).<span class="ruby-identifier">copy_blame!</span>(<span class="ruby-identifier">load_error</span>)
          <span class="ruby-keyword">else</span>
            <span class="ruby-identifier">raise</span>
          <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">end</span>

        <span class="ruby-identifier">add_template_helper</span>(<span class="ruby-identifier">class_name</span>.<span class="ruby-identifier">constantize</span>)
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-node">&quot;helper expects String, Symbol, or Module argument (was: #{args.inspect})&quot;</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># Evaluate block in template class if given.</span>
  <span class="ruby-identifier">master_helper_module</span>.<span class="ruby-identifier">module_eval</span>(&amp;<span class="ruby-identifier">block</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">block_given?</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-helper_attr">
            
              <b>helper_attr</b>(*attrs)
            
            <a href="../../../classes/ActionController/Helpers/ClassMethods.html#method-i-helper_attr" name="method-i-helper_attr" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              <p>Declares helper accessors for controller attributes. For example, the
following adds new <code>name</code> and <code>name=</code> instance
methods to a controller and makes them available to the view:</p>

<pre>helper_attr :name
attr_accessor :name</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-helper_attr_source')" id="l_method-i-helper_attr_source">show</a>
                
              </p>
              <div id="method-i-helper_attr_source" class="dyn-source">
                <pre><span class="ruby-comment"># File actionpack/lib/action_controller/helpers.rb, line 178</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">helper_attr</span>(*<span class="ruby-identifier">attrs</span>)
  <span class="ruby-identifier">attrs</span>.<span class="ruby-identifier">flatten</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">attr</span><span class="ruby-operator">|</span> <span class="ruby-identifier">helper_method</span>(<span class="ruby-identifier">attr</span>, <span class="ruby-node">&quot;#{attr}=&quot;</span>) }
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-helper_method">
            
              <b>helper_method</b>(*methods)
            
            <a href="../../../classes/ActionController/Helpers/ClassMethods.html#method-i-helper_method" name="method-i-helper_method" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              <p>Declare a controller method as a helper. For example, the following makes
the <code>current_user</code> controller method available to the view:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">ApplicationController</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActionController</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">helper_method</span> :<span class="ruby-identifier">current_user</span>, :<span class="ruby-identifier">logged_in?</span>

  <span class="ruby-keyword">def</span> <span class="ruby-identifier">current_user</span>
    <span class="ruby-ivar">@current_user</span> <span class="ruby-operator">||=</span> <span class="ruby-constant">User</span>.<span class="ruby-identifier">find_by_id</span>(<span class="ruby-identifier">session</span>[:<span class="ruby-identifier">user</span>])
  <span class="ruby-keyword">end</span>

   <span class="ruby-keyword">def</span> <span class="ruby-identifier">logged_in?</span>
     <span class="ruby-identifier">current_user</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword">nil</span>
   <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p>In a view:</p>

<pre>&lt;% if logged_in? -%&gt;Welcome, &lt;%= current_user.name %&gt;&lt;% end -%&gt;</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-helper_method_source')" id="l_method-i-helper_method_source">show</a>
                
              </p>
              <div id="method-i-helper_method_source" class="dyn-source">
                <pre><span class="ruby-comment"># File actionpack/lib/action_controller/helpers.rb, line 163</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">helper_method</span>(*<span class="ruby-identifier">methods</span>)
  <span class="ruby-identifier">methods</span>.<span class="ruby-identifier">flatten</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">method</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">master_helper_module</span>.<span class="ruby-identifier">module_eval</span> <span class="ruby-value">&lt;&lt;-end_eval
      def #{method}(*args, &amp;block)                    # def current_user(*args, &amp;block)
        controller.send(%(#{method}), *args, &amp;block)  #   controller.send(%(current_user), *args, &amp;block)
      end                                             # end
    end_eval</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-helpers">
            
              <b>helpers</b>()
            
            <a href="../../../classes/ActionController/Helpers/ClassMethods.html#method-i-helpers" name="method-i-helpers" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              <p>Provides a proxy to access helpers methods from outside the view.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-helpers_source')" id="l_method-i-helpers_source">show</a>
                
              </p>
              <div id="method-i-helpers_source" class="dyn-source">
                <pre><span class="ruby-comment"># File actionpack/lib/action_controller/helpers.rb, line 183</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">helpers</span>
  <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@helper_proxy</span>
    <span class="ruby-ivar">@helper_proxy</span> = <span class="ruby-constant">ActionView</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">new</span>
    <span class="ruby-ivar">@helper_proxy</span>.<span class="ruby-identifier">extend</span> <span class="ruby-identifier">master_helper_module</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-ivar">@helper_proxy</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
                    </div>

    </div>
  </body>
</html>    